<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的工作待辦清單</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --success-color: #27ae60;
            --bg-color: #f5f7fa;
            --text-color: #333;
        }

        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* 主容器：讓清單區域可以捲動 */
        .container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            padding-bottom: 120px; /* 為底部輸入區預留空間 */
        }

        h2 { color: var(--text-color); border-left: 5px solid var(--primary-color); padding-left: 10px; }

        .task-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }

        .task-info { display: flex; flex-direction: column; }
        .task-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
        .task-date { font-size: 0.85rem; color: #666; }

        .btn-done {
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .history-section { margin-top: 40px; opacity: 0.7; }
        .history-card { background: #e0e0e0; text-decoration: line-through; color: #777; }

        /* 底部輸入區域 */
        .input-area {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 20px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        input[type="text"] { flex: 1; max-width: 400px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        input[type="date"] { padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .btn-add { background-color: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        
        .empty-msg { text-align: center; color: #999; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container" id="app">
    <section>
        <h2>待辦事項</h2>
        <div id="pendingTasks"></div>
    </section>

    <section class="history-section">
        <h2>歷史紀錄 (已結案)</h2>
        <div id="historyTasks"></div>
    </section>
</div>

<div class="input-area">
    <input type="text" id="taskTitle" placeholder="請輸入工作內容...">
    <input type="date" id="taskDate">
    <button class="btn-add" onclick="addTask()">新增待辦</button>
</div>

<script>
    let tasks = JSON.parse(localStorage.getItem('myTasks')) || [];

    // 初始化：設定日期選擇器預設為今天
    document.getElementById('taskDate').valueAsDate = new Date();

    function render() {
        const pendingContainer = document.getElementById('pendingTasks');
        const historyContainer = document.getElementById('historyTasks');
        
        pendingContainer.innerHTML = '';
        historyContainer.innerHTML = '';

        const pendingList = tasks.filter(t => !t.completed);
        const historyList = tasks.filter(t => t.completed);

        if (pendingList.length === 0) pendingContainer.innerHTML = '<p class="empty-msg">目前沒有待辦事項，休息一下吧！</p>';
        
        pendingList.forEach(task => {
            pendingContainer.innerHTML += `
                <div class="task-card">
                    <div class="task-info">
                        <span class="task-title">${task.title}</span>
                        <span class="task-date">截止日期: ${task.date}</span>
                    </div>
                    <button class="btn-done" onclick="completeTask(${task.id})">結案</button>
                </div>
            `;
        });

        historyList.forEach(task => {
            historyContainer.innerHTML += `
                <div class="task-card history-card">
                    <div class="task-info">
                        <span class="task-title">${task.title}</span>
                        <span class="task-date">完成於: ${task.date}</span>
                    </div>
                    <span style="font-size: 0.8rem;">已存檔</span>
                </div>
            `;
        });

        localStorage.setItem('myTasks', JSON.stringify(tasks));
    }

    function addTask() {
        const titleInput = document.getElementById('taskTitle');
        const dateInput = document.getElementById('taskDate');

        if (!titleInput.value.trim()) {
            alert("請輸入工作內容！");
            return;
        }

        const newTask = {
            id: Date.now(),
            title: titleInput.value,
            date: dateInput.value,
            completed: false
        };

        tasks.push(newTask);
        titleInput.value = '';
        render();
        
        // 自動捲動到最上方看新任務
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function completeTask(id) {
        const index = tasks.findIndex(t => t.id === id);
        if (index !== -1) {
            tasks[index].completed = true;
            render();
        }
    }

    // 監聽 Enter 鍵
    document.getElementById('taskTitle').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') addTask();
    });

    render();
</script>

</body>
</html>
